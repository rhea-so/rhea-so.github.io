---
layout: post
title:  "DNS와 작동 원리"
date:   2021-01-01 23:44:00 +0900
categories: 인터넷
changefreq: daily
---

## 요약

![what-is-dns](/assets/2021-01-01-how-dns-works/what-is-dns.png)

**도메인 네임 시스템**(Domain Name System, DNS)은 호스트의 도메인 이름을 호스트의 네트워크 주소로 바꾸거나 그 반대의 변환을 수행할 수 있도록 하기 위해 개발되었습니다.  

특정 컴퓨터(또는 네트워크로 연결된 임의의 장치)의 주소를 찾기 위해, 사람이 이해하기 쉬운 도메인 이름을 숫자로 된 식별 번호(IP 주소)로 변환해 줍니다.  

도메인 네임 시스템은 흔히 "전화번호부"에 비유됩니다.  

인터넷 도메인 주소 체계로서 TCP/IP의 응용에서, www.example.com과 같은 주 컴퓨터의 도메인 이름을 192.168.1.0과 같은 IP 주소로 변환하고 라우팅 정보를 제공하는 분산형 데이터베이스 시스템입니다.

인터넷은 2개의 주요 이름공간을 관리하는데, 하나는 도메인 네임 계층, 다른 하나는 인터넷 프로토콜(IP) 주소 공간입니다.

도메인 네임 시스템은 도메인 네임 계층을 관리하며 해당 네임 계층과 주소 공간 간의 변환 서비스를 제공합니다.  
인터넷 네임 서버와 통신 프로토콜은 도메인 네임 시스템을 구현합니다.  

DNS 네임 서버는 도메인을 위한 DNS 레코드를 저장하는 서버입니다.  
DNS 네임 서버는 데이터베이스에 대한 쿼리의 응답 정보와 함께 응답합니다.

## 깊게 들어가기

### 역사

호스트의 숫자 주소 대신 더 단순한, 더 기억하기 쉬운 이름을 사용하는 일은 [ARPANET](https://ko.wikipedia.org/wiki/ARPANET) 시절로 거슬러 올라갑니다.

스탠퍼드 연구소(현재의 SRI 인터내셔널)는 ARPANET의 컴퓨터들의 숫자 주소와 호스트 이름을 매핑하는 `HOSTS.TXT`라는 이름의 텍스트 파일을 관리하였습니다.

할당 번호 목록(Assigned Numbers List)이라 불리던 숫자 주소들은 서던캘리포니아 대학교의 정보과학연구소 소속(소속팀은 SRI와 함께 밀접하게 일했음) 존 포스텔에 의해 관리되었습니다.

### 구조

**도메인 이름 공간**

![domain namespace](/assets/2021-01-01-how-dns-works/domain-namespace.png)

도메인 이름 공간은 도메인 이름을 트리 형태로 구성한 것입니다.  
트리의 각 노드는 0개 이상의 리소스 레코드(resource record)를 가집니다.  
트리는 루트 존(root zone)에서 시작하여 여러 개의 하위 존으로 나뉩니다.  
각 DNS 존은 하나의 권한 있는 네임 서버(authoritative name server)에 의해 관리되는 노드들의 집합입니다.

> 하나의 네임 서버가 여러 개의 존을 관리할 수도 있습니다

관리 권한은 분할되어서 새로운 존을 형성할 수 있습니다.  
이때, 기존의 도메인 이름 공간의 일부분이 서브도메인 형태로 다른 네임 서버에 권한이 위임됩니다고 합니다.  
그리고 기존의 존은 새로운 존에 대한 권한을 잃게 됩니다.

**도메인 이름 형성**

![domain name](/assets/2021-01-01-how-dns-works/domain-name.jpg)

도메인 이름 형성에 관한 규칙은 RFC 1035, RFC 1123, RFC 2181에 정의되어 있습니다.  
도메인 이름은 한 개 이상의 부분(레이블)로 이루어지고, 점으로 구분하여 붙여 씁니다.(예: example.com)

가장 오른쪽 레이블은 최상위 도메인을 의미합니다.  
예를 들어, 도메인 이름 www.example.com은 최상위 도메인 com에 속합니다.  

도메인의 계층 구조는 오른쪽부터 왼쪽으로 내려갑니다.  
왼쪽의 레이블은 오른쪽의 서브도메인입니다. 

예를 들어, 레이블 example은 com 도메인의 서브도메인이며, www는 example.com의 서브도메인입니다.  
서브도메인은 127단계까지 가능합니다.

각 레이블은 최대 63개 문자를 사용할 수 있고, 전체 도메인 이름은 253개 문자를 초과할 수 없습니다.  
실제로는 도메인 레지스트리에 더 짧은 제한을 가질 수 있습니다.

도메인 이름은 기술적으로 옥텟으로 표현할 수 있는 모든 문자를 사용할 수 있습니다(RFC 3696).  
그러나 DNS 루트 존과 대부분의 서브도메인에서는 제한된 형식과 문자들만 허용합니다.  

레이블에 사용될 수 있는 문자는 아스키 문자 집합의 부분집합과 알파벳 a부터 z, A부터 Z, 숫자 0부터 9와 하이픈(-)을 포함합니다.  
이 규칙은 letter(문자), digit(숫자), hyphen(하이픈)의 첫글자를 따서 LDH 규칙이라고 합니다.  
도메인 이름은 대소문자 구분없이 해석되고, 레이블은 하이픈으로 시작하거나 끝날 수 없습니다.

### 작동 원리

![how domain name service works](/assets/2021-01-01-how-dns-works/dns-works.png)

1.웹 브라우저에 www.naver.com을 입력하면 먼저 Local DNS에게 "www.naver.com"이라는 hostname"에 대한 IP 주소를 질의하여 Local DNS에 없으면 다른 DNS name 서버 정보를 받습니다 (Root DNS 정보 전달 받음)

> Root DNS란?
> 
> Root DNS (루트 네임서버) 는 인터넷의 도메인 네임 시스템의 루트 존입니다. 루트 존의 레코드의 요청에 직접 응답하고 적절한 최상위 도메인에 대해 권한이 있는 네임 서버 목록을 반환함으로써 다른 요청에 응답합니다. 전세계에 961개의 루트 DNS가 운영되고 있습니다.

2.Root DNS 서버에 "www.naver.com" 질의

3.Root DNS 서버로 부터 "com 도메인"을 관리하는 TLD (Top-Level Domain) 이름 서버 정보 전달 받습니다

> TLD는 .com을 관리하는 서버를 칭합니다

4.TLD에 "www.naver.com" 질의

5.TLD에서 "name.com" 관리하는 DNS 정보 전달

6."naver.com" 도메인을 관리하는 DNS 서버에 "www.naver.com" 호스트네임에 대한 IP 주소 질의

7.Local DNS 서버에게 "응! www.naver.com에 대한 IP 주소는 222.122.195.6 응답

8.Local DNS는 www.naver.com에 대한 IP 주소를 캐싱을 하고 IP 주소 정보 전달

## 참고

* [DNS와 작동 원리](https://velog.io/@goban/DNS와-작동원리)
